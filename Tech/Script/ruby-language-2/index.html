<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    
    <title>Ruby语言特性（下） | Ray Taylor Lin&#39;s world</title>
    <meta name="author" content="林寿山">
    
    <meta name="description" content="本文将接着上一篇《Ruby语言特性（上）》讲述Ruby语言的核心语言特性，包括Mixin、模块、开放类等等，并使用Ruby来定义自己的语法。这些特性都是重点和难点，透过这些特性可以感受到Ruby是一门灵活性极高的语言。">
    
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <meta property="og:title" content="Ruby语言特性（下）"/>
    <meta property="og:site_name" content="林寿山的技术博客 Ray Taylor Lin&#39;s world"/>

    <link rel="alternate" href="/atom.xml" title="Ray Taylor Lin&#39;s world" type="application/atom+xml">
    <link rel="stylesheet" href="/css/lib/font-awesome.css" type="text/css">
    <link rel="stylesheet" href="/css/lib/normalize.css" type="text/css">
    <link rel="stylesheet" href="/css/lib/furatto.css" type="text/css">
    <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">

    
        <link rel="stylesheet" href="/css/lib/prettify_raytaylorism.css" type="text/css">
        
    
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <script src="/js/jquery-1.10.2.min.js"></script>
    <script src="/js/jquery.jpanelmenu.js"></script>
</head>


<body class="container-fluid">
    <header id="page-header">
        <div class="navbar inverse-navbar">
    <div class="navbar-inner">
        <div class="container-center">
            <a href="/index.html" class="menu-trigger" data-meteocon="M">
                <i class="icon-reorder"></i>
            </a>
            <div class="nav-collapse navbar-responsive-collapse collapse">
                <nav id="menu">
                    <ul class="nav">
                        <li><a class="brand" id="blog-title" href="/index.html">Ray Taylor Lin&#39;s world</a></li>
                    </ul>
                    <div class="pull-right nav" id="nav-button-group">
                        
                            <a href="/" class="menu-home btn btn-primary btn-large">
                                <i class="icon-home icon-white"></i>
                                首页
                            </a>
                        
                            <a href="/archives" class="menu-archive btn btn-primary btn-large">
                                <i class="icon-archive icon-white"></i>
                                归档
                            </a>
                        
                            <a href="javascript:void(0);" class="menu-category btn btn-primary btn-large">
                                <i class="icon-archive icon-white"></i>
                                分类
                            </a>
                        
                            <a href="/reading" class="menu-reading btn btn-primary btn-large">
                                <i class="icon-book icon-white"></i>
                                读书
                            </a>
                        
                            <a href="/about" class="menu-about btn btn-primary btn-large">
                                <i class="icon-user icon-white"></i>
                                关于
                            </a>
                        
                    </div>
                </nav>
                <nav id="jPanelMenu-menu-side">
    <ul class="nav main-menu">
        <li><a class="brand" href="index.html">Ray Taylor Lin&#39;s world</a></li>
        
            <li>
                <a href="/" class="menu-home">
                    <i class="icon-home icon-white"></i>
                    首页
                </a>
            </li>
        
            <li>
                <a href="/archives" class="menu-archive">
                    <i class="icon-archive icon-white"></i>
                    归档
                </a>
            </li>
        
            <li>
                <a href="javascript:void(0);" class="menu-category">
                    <i class="icon-archive icon-white"></i>
                    分类
                </a>
            </li>
        
            <li>
                <a href="/reading" class="menu-reading">
                    <i class="icon-book icon-white"></i>
                    读书
                </a>
            </li>
        
            <li>
                <a href="/about" class="menu-about">
                    <i class="icon-user icon-white"></i>
                    关于
                </a>
            </li>
        
    </ul>

    <ul class="nav category-menu hide">
        <li>
            <span><a class="brand" href="javascript:void(0);">分类目录</a></span>
            <span><a class="btn-back brand pull-right" href="javascript:void(0);">
                <i class="icon-arrow-left"></i>
            </a></span>
        </li>

        

        

            

            <li collapse-level="0">
                <a href="/categories/daily/" class="collapse-level-0">
                    <i class="icon-caret-right"></i>
                    daily(6)
                </a>
            </li>

            

            

        

            <li collapse-level="0">
                <a href="/categories/Tech/" class="collapse-level-0">
                    <i class="icon-caret-right"></i>
                    Tech(49)
                </a>
            </li>

            

            

            <li collapse-level="1">
                <a href="/categories/Tech/IDE/" class="collapse-level-1">
                    <i class="icon-caret-right"></i>
                    IDE(2)
                </a>
            </li>

            

            

        

            <li collapse-level="1">
                <a href="/categories/Tech/Linux/" class="collapse-level-1">
                    <i class="icon-caret-right"></i>
                    Linux(2)
                </a>
            </li>

            

            

        

            <li collapse-level="1">
                <a href="/categories/Tech/algorithm/" class="collapse-level-1">
                    <i class="icon-caret-right"></i>
                    algorithm(6)
                </a>
            </li>

            

            

        

            <li collapse-level="1">
                <a href="/categories/Tech/other/" class="collapse-level-1">
                    <i class="icon-caret-right"></i>
                    other(1)
                </a>
            </li>

            

            

        

            <li collapse-level="1">
                <a href="/categories/Tech/git/" class="collapse-level-1">
                    <i class="icon-caret-right"></i>
                    git(4)
                </a>
            </li>

            

            

        

            <li collapse-level="1">
                <a href="/categories/Tech/Script/" class="collapse-level-1">
                    <i class="icon-caret-right"></i>
                    Script(11)
                </a>
            </li>

            

            

            <li collapse-level="2">
                <a href="/categories/Tech/Script/Lua/" class="collapse-level-2">
                    <i class="icon-caret-right"></i>
                    Lua(3)
                </a>
            </li>

            

            

        

            <li collapse-level="2">
                <a href="/categories/Tech/Script/Python/" class="collapse-level-2">
                    <i class="icon-caret-right"></i>
                    Python(4)
                </a>
            </li>

            

            

        

        

            <li collapse-level="1">
                <a href="/categories/Tech/web/" class="collapse-level-1">
                    <i class="icon-caret-right"></i>
                    web(23)
                </a>
            </li>

            

            

            <li collapse-level="2">
                <a href="/categories/Tech/web/CSS/" class="collapse-level-2">
                    <i class="icon-caret-right"></i>
                    CSS(3)
                </a>
            </li>

            

            

        

            <li collapse-level="2">
                <a href="/categories/Tech/web/HTML5/" class="collapse-level-2">
                    <i class="icon-caret-right"></i>
                    HTML5(2)
                </a>
            </li>

            

            

        

            <li collapse-level="2">
                <a href="/categories/Tech/web/HTTP/" class="collapse-level-2">
                    <i class="icon-caret-right"></i>
                    HTTP(7)
                </a>
            </li>

            

            

        

            <li collapse-level="2">
                <a href="/categories/Tech/web/Node-js/" class="collapse-level-2">
                    <i class="icon-caret-right"></i>
                    Node-js(10)
                </a>
            </li>

            

            

        

            <li collapse-level="2">
                <a href="/categories/Tech/web/javascript/" class="collapse-level-2">
                    <i class="icon-caret-right"></i>
                    javascript(1)
                </a>
            </li>

            

            

        

        

        

        
    </ul>
</nav>
            </div>
        </div>
    </div>
</div>

    </header>
    <div id="content-wrapper">
        <div class="container-center">
        <article class="post">
    <div class="article-title article-title-big">
        
    
        <h1>Ruby语言特性（下）</h1>
    

    </div>

    <div class="date-row ">
        <time datetime="2015-01-09T08:22:50.000Z">2015-01-09</time>
    </div>

    <div class="toc-wrap">
        <div class="toc-title">目录</div>
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-_模块与混入（Mixin）"><span class="toc-number">1.</span> <span class="toc-text">1. 模块与混入（Mixin）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-_元编程（metaprogramming）"><span class="toc-number">2.</span> <span class="toc-text">2. 元编程（metaprogramming）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1_开放类"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 开放类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2_使用method_missing"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 使用method_missing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3_使用模块"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 使用模块</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-_总结"><span class="toc-number">3.</span> <span class="toc-text">3. 总结</span></a></li></ol>
    </div>

    <div class="entry">
        <p>本文将接着上一篇<a href="/Tech/Script/ruby-language-1/">《Ruby语言特性（上）》</a>讲述Ruby语言的核心语言特性，包括Mixin、模块、开放类等等，并使用Ruby来定义自己的语法。这些特性都是重点和难点，透过这些特性可以感受到Ruby是一门灵活性极高的语言。</p>
<a id="more"></a>

<h1 id="1-_模块与混入（Mixin）">1. 模块与混入（Mixin）</h1>
<p>面向对象语言利用继承，将行为传播到相似的对象上。若一个对象像继承多种行为，一种做法是用多继承，如C++；Java采用接口解决这一问题，Ruby采用模块Mixin。模块是函数和常量的集合，若在类中包含一个模块，那么该模块的行为和常量也会成为类的一部分。</p>
<pre><code><span class="comment"># 定义模块ToFile</span>
<span class="class"><span class="keyword">module</span> <span class="title">ToFile</span></span>
  <span class="comment"># 获取文件名</span>
  <span class="function"><span class="keyword">def</span> </span>filename
    <span class="string">"object_name.txt"</span>
  <span class="keyword">end</span>

  <span class="comment"># 创建文件</span>
  <span class="function"><span class="keyword">def</span> </span>to_f
    <span class="constant">File</span>.open(filename, <span class="string">'w'</span>) {|f| f.write(to_s)}  <span class="comment"># 注意这里to_s在其他地方定义！</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="comment"># 定义用户类</span>
<span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>
  <span class="keyword">include</span> <span class="constant">ToFile</span>
  <span class="keyword">attr_accessor</span> <span class="symbol">:name</span>

  <span class="function"><span class="keyword">def</span> </span>initialize(name)
    <span class="variable">@name</span> = name
  <span class="keyword">end</span>

  <span class="function"><span class="keyword">def</span> </span>to_s
    name
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="constant">Person</span>.new(<span class="string">'matz'</span>).to_f  <span class="comment"># 创建了一个文件object_name.txt，里面包含内容matz</span>
</code></pre><p>上面的代码很好理解，只是有一点要注意：<code>to_s</code>在模块中使用，在类中实现，但定义模块的时候，实现它的类甚至还没有定义。这正是鸭子类型的精髓所在。<strong>写入文件的能力，和Person这个类没有一点关系（一个类就应该做属于它自己的事情）</strong>，但实际开发又需要把Person类写入文件这种额外功能，这时候mixin就可以轻松胜任这种要求。</p>
<p>Ruby有两个重要的mixin：枚举（enumerable）和比较（comparable）。若想让类可枚举，必须实现each方法；若想让类可比较，必须实现<code>&lt;=&gt;</code>（太空船）操作符（比较a,b两操作数，返回1、0或-1）。Ruby的字符串可以这样比较：<code>&#39;begin&#39; &lt;=&gt; &#39;end =&gt; -1</code>。数组有很多好用的方法：</p>
<pre><code><span class="operator">a</span> = [<span class="number">5</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>]
<span class="operator">a</span>.<span class="built_in">sort</span> =&gt; [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]  <span class="comment"># 整数已通过Fixnum类实现太空船操作符，因此可比较可排序</span>
<span class="operator">a</span>.<span class="keyword">any</span>? {|i| i &gt; <span class="number">4</span>} =&gt; <span class="constant">true</span>
<span class="operator">a</span>.all? {|i| i &gt; <span class="number">0</span>} =&gt; <span class="constant">true</span>
<span class="operator">a</span>.collect {|i| i * <span class="number">2</span>} =&gt; [<span class="number">10</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">2</span>]
<span class="operator">a</span>.select {|i| i % <span class="number">2</span> == <span class="number">0</span>} =&gt; [<span class="number">4</span>]
<span class="operator">a</span>.member?(<span class="number">2</span>) =&gt; <span class="constant">false</span>
<span class="operator">a</span>.inject {|product, i| product * i} =&gt; <span class="number">60</span>  <span class="comment"># 第一个参数是代码块上一次执行的结果，若不设初始值，则使用列表第一个值作为初始值</span>
</code></pre><h1 id="2-_元编程（metaprogramming）">2. 元编程（metaprogramming）</h1>
<p>所谓元编程，说白了就是“写能写程序的程序”，这说起来有点拗口，下面会通过实例来讲解。</p>
<h2 id="2-1_开放类">2.1 开放类</h2>
<p>可以重定义Ruby中的任何类，并给它们扩充任何你想要的方法，甚至能让Ruby完全瘫痪，比如重定义Class.new方法。对于开发类来说，这种权衡主要考虑了自由，有这种重定义任何类或对象的自由，就能写出即为通俗易懂的代码，但也要明白，自由越大、能力越强，担负的责任也越重。</p>
<pre><code><span class="class"><span class="keyword">class</span> <span class="title">Numeric</span></span>
  <span class="function"><span class="keyword">def</span> </span>inches
    <span class="keyword">self</span>
  <span class="keyword">end</span>
  <span class="function"><span class="keyword">def</span> </span>feet
    <span class="keyword">self</span> * <span class="number">12</span>.inches
  <span class="keyword">end</span>
  <span class="function"><span class="keyword">def</span> </span>miles
    <span class="keyword">self</span> * <span class="number">5280</span>.feet
  <span class="keyword">end</span>
  <span class="function"><span class="keyword">def</span> </span>back
    <span class="keyword">self</span> * -<span class="number">1</span>
  <span class="keyword">end</span>
  <span class="function"><span class="keyword">def</span> </span>forward
    <span class="keyword">self</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre><p>上面的代码通过开放Numeric类，就可以像这样采用最简单的语法实现用英寸表示距离：<code>puts 10.miles.back</code>，<code>puts 2.feet.forward</code>。</p>
<h2 id="2-2_使用method_missing">2.2 使用method_missing</h2>
<p>Ruby找不到某个方法时，会调用一个特殊的回调方法<code>method_missing</code>显示诊断信息。通过覆盖这个特殊方法，可以实现一些非常有趣且强大的功能。下面这个示例展示了如何用简洁的语法来实现罗马数字。</p>
<pre><code><span class="type">class</span> Roman
  <span class="comment"># 覆盖self.method_missing方法</span>
  def self.method_missing <span class="property">name</span>, *args
    roman = <span class="property">name</span>.to_s
    roman.gsub!(<span class="string">"IV"</span>, <span class="string">"IIII"</span>)
    roman.gsub!(<span class="string">"IX"</span>, <span class="string">"VIIII"</span>)
    roman.gsub!(<span class="string">"XL"</span>, <span class="string">"XXXX"</span>)
    roman.gsub!(<span class="string">"XC"</span>, <span class="string">"LXXXX"</span>)

    (roman.<span class="command">count</span>(<span class="string">"I"</span>) +
     roman.<span class="command">count</span>(<span class="string">"V"</span>) * <span class="number">5</span> +
     roman.<span class="command">count</span>(<span class="string">"X"</span>) * <span class="number">10</span> +
     roman.<span class="command">count</span>(<span class="string">"L"</span>) * <span class="number">50</span> +
     roman.<span class="command">count</span>(<span class="string">"C"</span>) * <span class="number">100</span>)
  <span class="keyword">end</span>
<span class="keyword">end</span>

puts Roman.III  <span class="comment"># =&gt; 3</span>
puts Roman.XII  <span class="comment"># =&gt; 12</span>
</code></pre><p>我们没有给Roman类定义什么实际的方法，但已经可以Roman类来表示任何罗马数字！其原理就是在没有找到定义方法时，把方法名称和参数传给<code>method_missing</code>执行。首先调用<code>to_s</code>把方法名转为字符串，然后将罗马数字“左减”特殊形式转换为“右加”形式（更容易计数），最后统计各个符号的个数和加权。</p>
<p>当然，如此强有力的工具也有其代价：类调试起来会更加困难，因为Ruby再也不会告诉你找不到某个方法。因此<code>method_missing</code>是一把双刃剑，它确实可以让语法大大简化，但是要以人为地加强程序的健壮性为前提。</p>
<h2 id="2-3_使用模块">2.3 使用模块</h2>
<p>Ruby最流行的元编程方式，非模块莫属。下面的代码讲述如何用模块的方式扩展一个可以读取csv文件的类。</p>
<pre><code><span class="class"><span class="keyword">module</span> <span class="title">ActsAsCsv</span></span>

  <span class="comment"># 只要某个模块被另一模块include，就会调用被include模块的included方法</span>
  <span class="function"><span class="keyword">def</span> </span><span class="keyword">self</span>.included(base)
    base.extend <span class="constant">ClassMethods</span>
  <span class="keyword">end</span>

  <span class="class"><span class="keyword">module</span> <span class="title">ClassMethods</span></span>
    <span class="function"><span class="keyword">def</span> </span>acts_as_csv
      <span class="keyword">include</span> <span class="constant">InstanceMethods</span>
    <span class="keyword">end</span>
  <span class="keyword">end</span>

  <span class="class"><span class="keyword">module</span> <span class="title">InstanceMethods</span></span>
    <span class="keyword">attr_accessor</span> <span class="symbol">:headers</span>, <span class="symbol">:csv_contents</span>

    <span class="function"><span class="keyword">def</span> </span>initialize
      read
    <span class="keyword">end</span>

    <span class="function"><span class="keyword">def</span> </span>read
      <span class="variable">@csv_contents</span> = []
      filename = <span class="keyword">self</span>.<span class="keyword">class</span>.to_s.downcase + <span class="string">'.txt'</span>
      file = <span class="constant">File</span>.new(filename)
      <span class="variable">@headers</span> = file.gets.chomp.split(<span class="string">', '</span>)  <span class="comment"># String的chomp方法去除字符串末尾的回车换行符</span>
      file.each <span class="keyword">do</span> |row|
        <span class="variable">@csv_contents</span> &lt;&lt; row.chomp.split(<span class="string">', '</span>)
      <span class="keyword">end</span>
    <span class="keyword">end</span>
  <span class="keyword">end</span>

<span class="keyword">end</span>  <span class="comment"># end of module ActsAsCsv</span>

<span class="class"><span class="keyword">class</span> <span class="title">RubyCsv</span>    <span class="comment"># 没有继承，可以自由添加</span></span>
  <span class="keyword">include</span> <span class="constant">ActsAsCsv</span>
  acts_as_csv
<span class="keyword">end</span>

m = <span class="constant">RubyCsv</span>.new
puts m.headers.inspect
puts m.csv_contents.inspect
</code></pre><p>上述代码中RubyCsv包含了ActsAsCsv，所以ActsAsCsv的included方法中，base就指RubyCsv，ActsAsCsv模块给RubyCsv类添加了唯一一个类方法<code>acts_as_csv</code>，这个方法又打开RubyCsv类，并在类中包含了所有实例方法。如此这般，就写了一个会写程序的程序（通过模块来动态添加类方法）。</p>
<p>一些出色的Ruby框架，如Builder和ActiveRecord，都会为了改善可读性而特别依赖元编程。借助元编程的威力，可以做到尽量缩短正确的Ruby语法与日常用于之间的距离。注意一切都是为了提升代码可读性而服务。</p>
<h1 id="3-_总结">3. 总结</h1>
<p>Ruby的纯面向对象可以让你用一致的方式来处理对象。鸭子类型根据对象可提供的方法，而不是对象的继承层次，实现了更切合实际的多态设计。Ruby的模块和开放类，使程序员能把行为紧密结合到语法上，大大超越了类中定义的传统方法和实例变量。</p>
<p>核心优势：</p>
<ul>
<li><strong>优雅的语法和强大的灵活性</strong></li>
<li>脚本：Ruby是一门梦幻般的脚本语言，可以出色地完成许多任务。Ruby许多语法糖可以大幅提高生产效率，各种各样的库和gem（Ruby包）可以满足绝大多数日常需要。</li>
<li>Web开发：很多人学Ruby最终就是为了用Ruby on Rails框架来进行Web开发。作为一个极其成功的MVC框架，其有着广泛的社区支持及优雅的语法。Twitter最初就是用Ruby实现的，借助Ruby无比强大的生产力，可以快速地开发出一个可推向市场的合格产品。</li>
</ul>
<p>不足之处：</p>
<ul>
<li><strong>性能</strong>：这是Ruby的最大弱点。随着时代的发展，Ruby的速度确实是越来越快。当然，Ruby是创建目的为了改善程序员的体验，在对性能要求不高的应用场景下，性能换来生产效率的大幅提升无疑是值得的。</li>
<li>并发和面向对象编程：面向对象是建立在状态包装一系列行为的基础上，但通常状态是会改变的。程序中存在并发时，这种编程策略就会引发严重问题。</li>
<li>类型安全：静态类型可提供一整套工具，可以更轻松地构造语法树，也因此能实现各种IDE。对Ruby这种动态类型语言来说，实现IDE就困难得多。</li>
</ul>
<p>参考资料：《七周七语言》第2章Ruby</p>

    </div>
    
    <footer >
        
            
    
    <div class="categories">
        所属目录：
    <a href="/categories/Tech/">Tech</a> -> <a href="/categories/Tech/Script/">Script</a>
    </div>

            
    
    <div class="tags-row">
        标签：<a class="btn btn-info" href="/tags/Ruby/">Ruby</a><a class="btn btn-info" href="/tags/编程范型/">编程范型</a>
    </div>

        
        <div class="clearfix"></div>
    </footer>
</article>



<section id="comment">
    <h1 class="page-sub-title">留言</h1>
    <!-- Duoshuo Comment BEGIN -->
    <div class="ds-thread" data-title="Ruby语言特性（下）">

    <script type="text/javascript">
        var duoshuoQuery = {short_name:"raytaylorlin"};
        (function() {
            var ds = document.createElement('script');
            ds.type = 'text/javascript';
            ds.async = true;
            ds.src = 'http://static.duoshuo.com/embed.js';
            ds.charset = 'UTF-8';
            (document.getElementsByTagName('head')[0] 
            || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
    </script>
    <!-- Duoshuo Comment END -->
    </div>
</section>


        </div>
    </div>
    <footer id="page-footer"><div class="footer-content">
    <div class="container-center">
        <div class="footer-text pull-left">
            <div class="copyright">
                
                Copyright &copy; 2015 <a href="/">林寿山</a>
                
            </div>
            <div class="theme-copyright">
                <span>Blog powered by <a href="http://zespia.tw/hexo/zh-CN/">hexo</a></span>
                Theme <a href="https://github.com/raytaylorlin/hexo-theme-raytaylorism">raytaylorism</a> desgined by <strong>Nix</strong>
            </div>
        </div>
        <div class="social-group pull-right">
            
            <a href="https://github.com/raytaylorlin" target="_blank" title="github"><i class="icon-github"></i></a>
            
            
            <a href="http://weibo.com/1956184117" target="_blank" title="新浪微博"><i class="icon-weibo"></i></a>
            
            
            <a href="http://www.renren.com/309069699" target="_blank" title="人人网"><i class="icon-renren"></i></a>
            
            
            <a href="https://plus.google.com/113216251417550089742?rel=author" target="_blank" title="Google+"><i class="icon-google-plus-sign"></i></a>
            
        </div>
        <div class="clearfix"></div>
    </div>
</div>
</footer>
    
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-43460643-1', 'raytaylorlin.com');
    ga('send', 'pageview');

</script>


<script src="/js/prettify.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $("pre").addClass("prettyprint");
        prettyPrint();
    });
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script>
    (function($) {
        //当内容区内容不够长时，设置内容区域的高度使footer沉底
        var resizeContentWrapper = function() {
            //HACK: 用延时的方法使计算高度时候更加准确，会有一闪的情况
            setTimeout(function() {
                var contentHeight = Math.floor($('#content-wrapper .container-center').height()),
                headerHeight = Math.floor($('#page-header').height()),
                footerHeight = Math.floor($('#page-footer').height()),
                minHeight = Math.floor($(window).height() - headerHeight - footerHeight);
                if(contentHeight < minHeight) {
                    $('#content-wrapper').css({height: minHeight});                    
                } else {
                    $('#content-wrapper').css({height: 'auto'});
                }
            },500);
        };

        //响应式侧边栏
        var initJPanelMenu = function() {
            var jPM = $.jPanelMenu({
                menu: '#jPanelMenu-menu-side',
                duration: 500
            });
            jPM.on();
        };

        //初始化目录按钮事件绑定
        var initCategory = function() {
            function showMainMenu() {
                var $jPanelMenu = $('#jPanelMenu-menu');
                $jPanelMenu.find('ul.category-menu').hide();
                $jPanelMenu.find('ul.main-menu').fadeIn();
            }

            function showCategoryMenu() {
                var $jPanelMenu = $('#jPanelMenu-menu');
                $jPanelMenu.find('ul.main-menu').hide();
                $jPanelMenu.find('ul.category-menu').fadeIn();
            }

            $('.menu-category').click(function() {
                var jPM = $.jPanelMenu({
                    duration: 500,
                    beforeOpen: function() {
                        showCategoryMenu();
                    },
                    afterClose: function() {
                        showMainMenu();
                    }
                });
                if(jPM.isOpen()) {
                    showCategoryMenu();
                } else {
                    jPM.open();
                }
            });

            $('.category-menu').on('click', '.btn-back', function() {
                showMainMenu();
            });
        };

        $(document).ready(resizeContentWrapper);
        $(document).ready(initJPanelMenu);
        $(document).ready(initCategory);
        
        $(window).resize(resizeContentWrapper);
    })(jQuery);
</script>
</body>
</html>